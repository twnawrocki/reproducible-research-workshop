<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Timm Nawrocki" />

<meta name="date" content="2018-05-17" />

<title>SASAP Reproducible Analyses in R Workshop</title>

<script src="sasap_workshop_files/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="sasap_workshop_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="sasap_workshop_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="sasap_workshop_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="sasap_workshop_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="sasap_workshop_files/navigation-1.1/tabsets.js"></script>
<link href="sasap_workshop_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="sasap_workshop_files/highlightjs-9.12.0/highlight.js"></script>
<script src="sasap_workshop_files/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="sasap_workshop_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="sasap_workshop_files/datatables-binding-0.5/datatables.js"></script>
<link href="sasap_workshop_files/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="sasap_workshop_files/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="sasap_workshop_files/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="sasap_workshop_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="sasap_workshop_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="sasap_workshop_files/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="sasap_workshop_files/leaflet-1.3.1/leaflet.js"></script>
<link href="sasap_workshop_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="sasap_workshop_files/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="sasap_workshop_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="sasap_workshop_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="sasap_workshop_files/leaflet-binding-2.0.2/leaflet.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">



<h1 class="title toc-ignore">SASAP Reproducible Analyses in R Workshop</h1>
<h4 class="author"><em>Timm Nawrocki</em></h4>
<h4 class="date"><em>May 17, 2018</em></h4>

</div>

<div id="TOC">
<ul>
<li><a href="#code-header"><span class="toc-section-number">1</span> Code header</a></li>
<li><a href="#set-up-session"><span class="toc-section-number">2</span> Set up session</a></li>
<li><a href="#example-plot-and-table"><span class="toc-section-number">3</span> Example Plot and Table</a></li>
<li><a href="#tidying-data-using-dplyr-and-tidyr"><span class="toc-section-number">4</span> Tidying data using dplyr and tidyr</a><ul>
<li><a href="#data-preparation-exercise"><span class="toc-section-number">4.1</span> Data Preparation Exercise</a></li>
</ul></li>
<li><a href="#foundations-of-ggplot2"><span class="toc-section-number">5</span> Foundations of ggplot2</a></li>
<li><a href="#publishing-data-workflows-and-products-to-the-web-for-collaboration"><span class="toc-section-number">6</span> Publishing data, workflows, and products to the web for collaboration</a><ul>
<li><a href="#simple-web-mapping"><span class="toc-section-number">6.1</span> Simple web mapping</a></li>
</ul></li>
</ul>
</div>

<div id="code-header" class="section level1">
<h1><span class="header-section-number">1</span> Code header</h1>
<pre class="r"><code># -*- coding: utf-8 -*-
# ---------------------------------------------------------------------------
# SASAP Reproducible Analyses in R Workshop
# Author: Timm Nawrocki
# Created on: 2018-05-17
# Usage: Code is intended to be executed as an R markdown or R script in RStudio.
# Description: &quot;R Assignment 2: Data Summary&quot; is an R assignment for BIOL-A601, Fall 2018.
# ---------------------------------------------------------------------------</code></pre>
</div>
<div id="set-up-session" class="section level1">
<h1><span class="header-section-number">2</span> Set up session</h1>
<p>The set up code installs libraries used in this assignment if any are not already installed. Sets a working file based on user input.</p>
<p>The environment settings for this session are:</p>
<pre><code>## R version 3.5.1 (2018-07-02)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 17134)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United States.1252 
## [2] LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252
## [4] LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] tidyr_0.8.1      remotes_2.0.2    readxl_1.1.0     leaflet_2.0.2   
##  [5] kableExtra_0.9.0 ggpmisc_0.3.0    ggplot2_3.0.0    DT_0.5          
##  [9] dplyr_0.7.6      usethis_1.4.0    devtools_2.0.1  
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_0.2.5  purrr_0.2.5       colorspace_1.3-2 
##  [4] viridisLite_0.3.0 htmltools_0.3.6   yaml_2.2.0       
##  [7] base64enc_0.1-3   rlang_0.2.2       pkgbuild_1.0.2   
## [10] later_0.7.5       pillar_1.3.0      glue_1.3.0       
## [13] withr_2.1.2       sessioninfo_1.1.1 bindrcpp_0.2.2   
## [16] bindr_0.1.1       plyr_1.8.4        stringr_1.3.1    
## [19] cellranger_1.1.0  munsell_0.5.0     gtable_0.2.0     
## [22] rvest_0.3.2       htmlwidgets_1.3   memoise_1.1.0    
## [25] evaluate_0.11     knitr_1.20        callr_3.0.0      
## [28] httpuv_1.4.5      crosstalk_1.0.0   ps_1.2.1         
## [31] Rcpp_0.12.18      xtable_1.8-3      readr_1.1.1      
## [34] promises_1.0.1    backports_1.1.2   scales_1.0.0     
## [37] desc_1.2.0        pkgload_1.0.2     mime_0.5         
## [40] fs_1.2.6          hms_0.4.2         digest_0.6.16    
## [43] stringi_1.1.7     shiny_1.2.0       processx_3.2.0   
## [46] rprojroot_1.3-2   grid_3.5.1        cli_1.0.1        
## [49] tools_3.5.1       magrittr_1.5      lazyeval_0.2.1   
## [52] tibble_1.4.2      crayon_1.3.4      pkgconfig_2.0.2  
## [55] xml2_1.2.0        prettyunits_1.0.2 assertthat_0.2.0 
## [58] rmarkdown_1.10    httr_1.3.1        rstudioapi_0.8   
## [61] R6_2.3.0          compiler_3.5.1</code></pre>
</div>
<div id="example-plot-and-table" class="section level1">
<h1><span class="header-section-number">3</span> Example Plot and Table</h1>
<p>The following code produces an example point plot based on random numbers.</p>
<pre class="r"><code># Create example plot in the markdown document
ggplot(data.frame(x=rnorm(100), y=rnorm(100)), aes(x,y)) +
  geom_point() +
  theme_bw()</code></pre>
<p><img src="sasap_workshop_files/figure-html/examplePlot-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>data(&#39;mpg&#39;)</code></pre>
<p>The following code produces an example table using the “mpg” dataset.</p>
<pre class="r"><code># Import example dataset and output a table in the markdown document
data(&#39;mpg&#39;)
datatable(mpg, caption=&#39;Mileage&#39;)</code></pre>
<div id="htmlwidget-76ccce4ee810cf149e05" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-76ccce4ee810cf149e05">{"x":{"filter":"none","caption":"<caption>Mileage<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234"],["audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","honda","honda","honda","honda","honda","honda","honda","honda","honda","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","jeep","jeep","jeep","jeep","jeep","jeep","jeep","jeep","land rover","land rover","land rover","land rover","lincoln","lincoln","lincoln","mercury","mercury","mercury","mercury","nissan","nissan","nissan","nissan","nissan","nissan","nissan","nissan","nissan","nissan","nissan","nissan","nissan","pontiac","pontiac","pontiac","pontiac","pontiac","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen"],["a4","a4","a4","a4","a4","a4","a4","a4 quattro","a4 quattro","a4 quattro","a4 quattro","a4 quattro","a4 quattro","a4 quattro","a4 quattro","a6 quattro","a6 quattro","a6 quattro","c1500 suburban 2wd","c1500 suburban 2wd","c1500 suburban 2wd","c1500 suburban 2wd","c1500 suburban 2wd","corvette","corvette","corvette","corvette","corvette","k1500 tahoe 4wd","k1500 tahoe 4wd","k1500 tahoe 4wd","k1500 tahoe 4wd","malibu","malibu","malibu","malibu","malibu","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","durango 4wd","durango 4wd","durango 4wd","durango 4wd","durango 4wd","durango 4wd","durango 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","expedition 2wd","expedition 2wd","expedition 2wd","explorer 4wd","explorer 4wd","explorer 4wd","explorer 4wd","explorer 4wd","explorer 4wd","f150 pickup 4wd","f150 pickup 4wd","f150 pickup 4wd","f150 pickup 4wd","f150 pickup 4wd","f150 pickup 4wd","f150 pickup 4wd","mustang","mustang","mustang","mustang","mustang","mustang","mustang","mustang","mustang","civic","civic","civic","civic","civic","civic","civic","civic","civic","sonata","sonata","sonata","sonata","sonata","sonata","sonata","tiburon","tiburon","tiburon","tiburon","tiburon","tiburon","tiburon","grand cherokee 4wd","grand cherokee 4wd","grand cherokee 4wd","grand cherokee 4wd","grand cherokee 4wd","grand cherokee 4wd","grand cherokee 4wd","grand cherokee 4wd","range rover","range rover","range rover","range rover","navigator 2wd","navigator 2wd","navigator 2wd","mountaineer 4wd","mountaineer 4wd","mountaineer 4wd","mountaineer 4wd","altima","altima","altima","altima","altima","altima","maxima","maxima","maxima","pathfinder 4wd","pathfinder 4wd","pathfinder 4wd","pathfinder 4wd","grand prix","grand prix","grand prix","grand prix","grand prix","forester awd","forester awd","forester awd","forester awd","forester awd","forester awd","impreza awd","impreza awd","impreza awd","impreza awd","impreza awd","impreza awd","impreza awd","impreza awd","4runner 4wd","4runner 4wd","4runner 4wd","4runner 4wd","4runner 4wd","4runner 4wd","camry","camry","camry","camry","camry","camry","camry","camry solara","camry solara","camry solara","camry solara","camry solara","camry solara","camry solara","corolla","corolla","corolla","corolla","corolla","land cruiser wagon 4wd","land cruiser wagon 4wd","toyota tacoma 4wd","toyota tacoma 4wd","toyota tacoma 4wd","toyota tacoma 4wd","toyota tacoma 4wd","toyota tacoma 4wd","toyota tacoma 4wd","gti","gti","gti","gti","gti","jetta","jetta","jetta","jetta","jetta","jetta","jetta","jetta","jetta","new beetle","new beetle","new beetle","new beetle","new beetle","new beetle","passat","passat","passat","passat","passat","passat","passat"],[1.8,1.8,2,2,2.8,2.8,3.1,1.8,1.8,2,2,2.8,2.8,3.1,3.1,2.8,3.1,4.2,5.3,5.3,5.3,5.7,6,5.7,5.7,6.2,6.2,7,5.3,5.3,5.7,6.5,2.4,2.4,3.1,3.5,3.6,2.4,3,3.3,3.3,3.3,3.3,3.3,3.8,3.8,3.8,4,3.7,3.7,3.9,3.9,4.7,4.7,4.7,5.2,5.2,3.9,4.7,4.7,4.7,5.2,5.7,5.9,4.7,4.7,4.7,4.7,4.7,4.7,5.2,5.2,5.7,5.9,4.6,5.4,5.4,4,4,4,4,4.6,5,4.2,4.2,4.6,4.6,4.6,5.4,5.4,3.8,3.8,4,4,4.6,4.6,4.6,4.6,5.4,1.6,1.6,1.6,1.6,1.6,1.8,1.8,1.8,2,2.4,2.4,2.4,2.4,2.5,2.5,3.3,2,2,2,2,2.7,2.7,2.7,3,3.7,4,4.7,4.7,4.7,5.7,6.1,4,4.2,4.4,4.6,5.4,5.4,5.4,4,4,4.6,5,2.4,2.4,2.5,2.5,3.5,3.5,3,3,3.5,3.3,3.3,4,5.6,3.1,3.8,3.8,3.8,5.3,2.5,2.5,2.5,2.5,2.5,2.5,2.2,2.2,2.5,2.5,2.5,2.5,2.5,2.5,2.7,2.7,3.4,3.4,4,4.7,2.2,2.2,2.4,2.4,3,3,3.5,2.2,2.2,2.4,2.4,3,3,3.3,1.8,1.8,1.8,1.8,1.8,4.7,5.7,2.7,2.7,2.7,3.4,3.4,4,4,2,2,2,2,2.8,1.9,2,2,2,2,2.5,2.5,2.8,2.8,1.9,1.9,2,2,2.5,2.5,1.8,1.8,2,2,2.8,2.8,3.6],[1999,1999,2008,2008,1999,1999,2008,1999,1999,2008,2008,1999,1999,2008,2008,1999,2008,2008,2008,2008,2008,1999,2008,1999,1999,2008,2008,2008,2008,2008,1999,1999,1999,2008,1999,2008,2008,1999,1999,1999,1999,2008,2008,2008,1999,1999,2008,2008,2008,2008,1999,1999,2008,2008,2008,1999,1999,1999,2008,2008,2008,1999,2008,1999,2008,2008,2008,2008,2008,2008,1999,1999,2008,1999,1999,1999,2008,1999,1999,1999,2008,2008,1999,1999,1999,1999,1999,2008,1999,2008,1999,1999,2008,2008,1999,1999,2008,2008,2008,1999,1999,1999,1999,1999,2008,2008,2008,2008,1999,1999,2008,2008,1999,1999,2008,1999,1999,2008,2008,2008,2008,2008,2008,2008,1999,1999,2008,2008,2008,2008,1999,2008,2008,1999,1999,1999,2008,1999,2008,2008,1999,1999,1999,2008,2008,2008,2008,1999,1999,2008,1999,1999,2008,2008,1999,1999,1999,2008,2008,1999,1999,2008,2008,2008,2008,1999,1999,1999,1999,2008,2008,2008,2008,1999,1999,1999,1999,2008,2008,1999,1999,2008,2008,1999,1999,2008,1999,1999,2008,2008,1999,1999,2008,1999,1999,1999,2008,2008,1999,2008,1999,1999,2008,1999,1999,2008,2008,1999,1999,2008,2008,1999,1999,1999,1999,2008,2008,2008,2008,1999,1999,1999,1999,1999,1999,2008,2008,1999,1999,2008,2008,1999,1999,2008],[4,4,4,4,6,6,6,4,4,4,4,6,6,6,6,6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,4,6,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,6,6,8,8,8,8,8,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,6,6,6,6,8,8,6,6,8,8,8,8,8,6,6,6,6,8,8,8,8,8,4,4,4,4,4,4,4,4,4,4,4,4,4,6,6,6,4,4,4,4,6,6,6,6,6,6,8,8,8,8,8,8,8,8,8,8,8,8,6,6,8,8,4,4,4,4,6,6,6,6,6,6,6,6,8,6,6,6,6,8,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,6,6,6,8,4,4,4,4,6,6,6,4,4,4,4,6,6,6,4,4,4,4,4,8,8,4,4,4,6,6,6,6,4,4,4,4,6,4,4,4,4,4,5,5,6,6,4,4,4,4,5,5,4,4,4,4,6,6,6],["auto(l5)","manual(m5)","manual(m6)","auto(av)","auto(l5)","manual(m5)","auto(av)","manual(m5)","auto(l5)","manual(m6)","auto(s6)","auto(l5)","manual(m5)","auto(s6)","manual(m6)","auto(l5)","auto(s6)","auto(s6)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","manual(m6)","auto(l4)","manual(m6)","auto(s6)","manual(m6)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(s6)","auto(l3)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l6)","auto(l6)","manual(m6)","auto(l4)","auto(l4)","manual(m5)","auto(l5)","auto(l5)","auto(l5)","manual(m5)","auto(l4)","auto(l4)","auto(l5)","auto(l5)","auto(l5)","auto(l4)","auto(l5)","auto(l4)","manual(m6)","auto(l5)","auto(l5)","auto(l5)","manual(m6)","manual(m6)","auto(l4)","manual(m5)","auto(l5)","auto(l4)","auto(l4)","auto(l4)","auto(l6)","auto(l5)","manual(m5)","auto(l5)","auto(l5)","auto(l6)","auto(l4)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","manual(m5)","auto(l4)","manual(m5)","auto(l5)","auto(l4)","manual(m5)","manual(m5)","auto(l5)","manual(m6)","manual(m5)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","manual(m5)","auto(l5)","auto(l5)","manual(m6)","auto(l4)","manual(m5)","auto(l4)","manual(m5)","auto(l4)","manual(m5)","auto(l5)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","auto(l4)","manual(m6)","manual(m5)","auto(l5)","auto(l5)","auto(l4)","auto(l4)","auto(l5)","auto(l5)","auto(l5)","auto(l5)","auto(l4)","auto(s6)","auto(s6)","auto(l4)","auto(l4)","auto(l4)","auto(l6)","auto(l5)","auto(l5)","auto(l6)","auto(l4)","manual(m5)","auto(l4)","auto(av)","manual(m6)","manual(m6)","auto(av)","auto(l4)","manual(m5)","auto(av)","auto(l4)","manual(m5)","auto(l5)","auto(s5)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(s4)","manual(m5)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","auto(l4)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","auto(s4)","auto(s4)","manual(m5)","manual(m5)","manual(m5)","auto(l4)","auto(l4)","manual(m5)","auto(l5)","auto(l5)","manual(m5)","auto(l4)","manual(m5)","auto(l5)","auto(l4)","manual(m5)","auto(s6)","auto(l4)","manual(m5)","manual(m5)","auto(s5)","auto(l4)","manual(m5)","auto(s5)","auto(l3)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","auto(l4)","auto(s6)","manual(m5)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","manual(m6)","auto(l5)","manual(m5)","auto(l4)","manual(m6)","auto(s6)","manual(m5)","manual(m5)","manual(m5)","auto(l4)","auto(s6)","manual(m6)","auto(s6)","manual(m5)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","manual(m5)","auto(l4)","manual(m5)","auto(s6)","manual(m5)","auto(l5)","auto(s6)","manual(m6)","auto(l5)","manual(m5)","auto(s6)"],["f","f","f","f","f","f","f","4","4","4","4","4","4","4","4","4","4","4","r","r","r","r","r","r","r","r","r","r","4","4","4","4","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","r","r","r","4","4","4","4","4","4","4","4","4","4","4","4","4","r","r","r","r","r","r","r","r","r","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","4","4","4","4","4","4","4","4","4","4","4","4","r","r","r","4","4","4","4","f","f","f","f","f","f","f","f","f","4","4","4","4","f","f","f","f","f","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","4","4","4","4","4","4","4","4","4","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f"],[18,21,20,21,16,18,18,18,16,20,19,15,17,17,15,15,17,16,14,11,14,13,12,16,15,16,15,15,14,11,11,14,19,22,18,18,17,18,17,16,16,17,17,11,15,15,16,16,15,14,13,14,14,14,9,11,11,13,13,9,13,11,13,11,12,9,13,13,12,9,11,11,13,11,11,11,12,14,15,14,13,13,13,14,14,13,13,13,11,13,18,18,17,16,15,15,15,15,14,28,24,25,23,24,26,25,24,21,18,18,21,21,18,18,19,19,19,20,20,17,16,17,17,15,15,14,9,14,13,11,11,12,12,11,11,11,12,14,13,13,13,21,19,23,23,19,19,18,19,19,14,15,14,12,18,16,17,18,16,18,18,20,19,20,18,21,19,19,19,20,20,19,20,15,16,15,15,16,14,21,21,21,21,18,18,19,21,21,21,22,18,18,18,24,24,26,28,26,11,13,15,16,17,15,15,15,16,21,19,21,22,17,33,21,19,22,21,21,21,16,17,35,29,21,19,20,20,21,18,19,21,16,18,17],[29,29,31,30,26,26,27,26,25,28,27,25,25,25,25,24,25,23,20,15,20,17,17,26,23,26,25,24,19,14,15,17,27,30,26,29,26,24,24,22,22,24,24,17,22,21,23,23,19,18,17,17,19,19,12,17,15,17,17,12,17,16,18,15,16,12,17,17,16,12,15,16,17,15,17,17,18,17,19,17,19,19,17,17,17,16,16,17,15,17,26,25,26,24,21,22,23,22,20,33,32,32,29,32,34,36,36,29,26,27,30,31,26,26,28,26,29,28,27,24,24,24,22,19,20,17,12,19,18,14,15,18,18,15,17,16,18,17,19,19,17,29,27,31,32,27,26,26,25,25,17,17,20,18,26,26,27,28,25,25,24,27,25,26,23,26,26,26,26,25,27,25,27,20,20,19,17,20,17,29,27,31,31,26,26,28,27,29,31,31,26,26,27,30,33,35,37,35,15,18,20,20,22,17,19,18,20,29,26,29,29,24,44,29,26,29,29,29,29,23,24,44,41,29,26,28,29,29,29,28,29,26,26,26],["p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","r","e","r","r","r","p","p","p","p","p","r","e","r","d","r","r","r","r","r","r","r","r","r","r","r","e","r","r","r","r","r","r","r","r","r","r","e","r","r","r","r","e","r","r","r","r","r","e","r","r","r","e","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","p","r","r","r","p","r","r","r","c","p","r","r","r","r","r","r","r","r","r","r","r","r","r","r","d","r","r","r","e","r","r","p","p","r","r","p","r","p","r","r","r","r","r","r","r","r","r","p","p","r","r","p","r","r","p","p","r","p","r","r","p","r","r","r","p","r","p","r","r","r","r","p","r","p","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","p","p","r","d","r","r","p","p","r","r","r","r","d","d","r","r","r","r","p","p","p","p","p","p","p"],["compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","midsize","midsize","midsize","suv","suv","suv","suv","suv","2seater","2seater","2seater","2seater","2seater","suv","suv","suv","suv","midsize","midsize","midsize","midsize","midsize","minivan","minivan","minivan","minivan","minivan","minivan","minivan","minivan","minivan","minivan","minivan","pickup","pickup","pickup","pickup","pickup","pickup","pickup","pickup","pickup","suv","suv","suv","suv","suv","suv","suv","pickup","pickup","pickup","pickup","pickup","pickup","pickup","pickup","pickup","pickup","suv","suv","suv","suv","suv","suv","suv","suv","suv","pickup","pickup","pickup","pickup","pickup","pickup","pickup","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","midsize","midsize","midsize","midsize","midsize","midsize","midsize","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","compact","compact","midsize","midsize","midsize","midsize","midsize","midsize","midsize","suv","suv","suv","suv","midsize","midsize","midsize","midsize","midsize","suv","suv","suv","suv","suv","suv","subcompact","subcompact","subcompact","subcompact","compact","compact","compact","compact","suv","suv","suv","suv","suv","suv","midsize","midsize","midsize","midsize","midsize","midsize","midsize","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","suv","suv","pickup","pickup","pickup","pickup","pickup","pickup","pickup","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","midsize","midsize","midsize","midsize","midsize","midsize","midsize"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>manufacturer<\/th>\n      <th>model<\/th>\n      <th>displ<\/th>\n      <th>year<\/th>\n      <th>cyl<\/th>\n      <th>trans<\/th>\n      <th>drv<\/th>\n      <th>cty<\/th>\n      <th>hwy<\/th>\n      <th>fl<\/th>\n      <th>class<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,8,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="tidying-data-using-dplyr-and-tidyr" class="section level1">
<h1><span class="header-section-number">4</span> Tidying data using dplyr and tidyr</h1>
<pre class="r"><code># Read in csv from url
catch_data = read.csv(url(&quot;https://knb.ecoinformatics.org/knb/d1/mn/v2/object/df35b.302.1&quot;, method = &quot;libcurl&quot;), stringsAsFactors = FALSE)</code></pre>
<p>The pipe function (%&gt;%) takes an initial defined argument and passes it as the first argument in an initial command. For every subsequent command where the pipe is repeated, the output from the last command is input as the first argument in a subsequent command. The final command needs to be stored as a variable.</p>
<pre class="r"><code># Select columns for analysis and transpose into a new table shape
catch_data = catch_data %&gt;%
  select(Region, Year, Chinook, Sockeye, Coho, Pink, Chum)

# Gather the data frame and save as a new data frame
catch_gather = gather(catch_data, key = species, value = catch, Chinook, Sockeye, Coho, Pink, Chum)</code></pre>
<p>The output table has “gathered” the catch-species columns into a “species” column and a “catch” column. The key specifies the new column name for the column names listed in the arguments and the value specifies the new column name for the values that existed within the columns listed in the arguments.</p>
<pre class="r"><code># Spread the gathered data back to its wide form and save as a new data frame
catch_spread = spread(catch_gather, key = species, value = catch, fill = NA)</code></pre>
<p>The syntax for spreading the data functions in opposite such that key specifies the column headings to be added and the value parses into those columns.</p>
<pre class="r"><code># Add a new field to data frame and multiply by 1000 to correct for units. An error for a non-numeric value in row 401 is corrected by converting to integer.
catch_gather = catch_gather %&gt;% 
  rename(catch_thousands = catch) %&gt;%
  rename(regionCode = Region) %&gt;%
  mutate(catch_thousands = ifelse(catch_thousands == &quot;I&quot;, 1, catch_thousands),
         catch_thousands = as.integer(catch_thousands)) %&gt;%
  mutate(catch = catch_thousands * 1000)</code></pre>
<pre class="r"><code># Example summary by species
catch_species = catch_gather %&gt;%
  group_by(species) %&gt;%
  summarize(catch_mean = mean(catch), num_obs = n())

# Example summary for Chinook salmon by year
catch_chinookYear = catch_gather %&gt;%
  filter(species == &#39;Chinook&#39;) %&gt;%
  group_by(Year) %&gt;%
  summarize(catch_mean = mean(catch), num_obs = n()) %&gt;%
  arrange(desc(catch_mean))

# Display table
datatable(catch_chinookYear, caption=&#39;Summary Table&#39;)</code></pre>
<div id="htmlwidget-f11362e4a2c8f4186b85" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f11362e4a2c8f4186b85">{"x":{"filter":"none","caption":"<caption>Summary Table<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120"],[1937,1924,1919,1923,1938,1982,1927,1930,1932,1936,1978,1983,1981,1941,1925,1951,1939,1979,1935,1929,1952,1942,1947,1985,1946,1953,1949,1912,1987,1948,1980,1993,1920,1984,1990,1926,1971,1921,1950,1970,1964,1969,1994,1995,1943,1997,1977,1931,1986,1967,1968,1991,1954,1959,1992,1945,1918,1988,1928,1933,1955,1960,1965,1915,1913,1989,1917,1974,1972,1958,1973,1996,1940,1966,1914,1976,1916,1934,1957,1922,1961,1963,1944,1962,1975,1956,1910,1907,1909,1911,1905,1903,1901,1906,1908,1902,1904,1900,1893,1899,1895,1897,1896,1894,1898,1891,1890,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1892],[61000,59588.2352941177,57000,54941.1764705882,53058.8235294118,51529.4117647059,51470.5882352941,49529.4117647059,49411.7647058823,49352.9411764706,49117.6470588235,48823.5294117647,48294.1176470588,47588.2352941177,46941.1764705882,46411.7647058823,46117.6470588235,45882.3529411765,44470.5882352941,43647.0588235294,43235.2941176471,42823.5294117647,42647.0588235294,42411.7647058823,42352.9411764706,42000,40882.3529411765,40142.8571428571,40058.8235294118,40000,39647.0588235294,39529.4117647059,39411.7647058823,39235.2941176471,39235.2941176471,38941.1764705882,38823.5294117647,38647.0588235294,38588.2352941177,37823.5294117647,37705.8823529412,37470.5882352941,37235.2941176471,36823.5294117647,36647.0588235294,36533.3333333333,36529.4117647059,36470.5882352941,36294.1176470588,36000,36000,35941.1764705882,35705.8823529412,35705.8823529412,35588.2352941177,35235.2941176471,34764.7058823529,34647.0588235294,34411.7647058823,34294.1176470588,34294.1176470588,34250,34117.6470588235,33937.5,33800,33647.0588235294,33312.5,32941.1764705882,32588.2352941176,32529.4117647059,32294.1176470588,32000,31882.3529411765,31764.7058823529,31437.5,31117.6470588235,30687.5,30647.0588235294,30470.5882352941,29705.8823529412,29647.0588235294,29588.2352941176,27470.5882352941,27058.8235294118,26823.5294117647,26764.7058823529,25307.6923076923,24750,24076.9230769231,22714.2857142857,20454.5454545455,20100,18777.7777777778,18000,17615.3846153846,17500,15727.2727272727,12222.2222222222,11125,10888.8888888889,8375,6888.88888888889,6444.44444444444,6000,6000,857.142857142857,714.285714285714,0,0,0,0,0,0,0,0,0,0,0,0,0],[17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,14,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,15,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,16,17,16,15,17,16,17,17,17,17,17,17,17,16,17,16,17,17,17,17,17,17,17,17,17,13,12,13,14,11,10,9,12,13,10,11,9,8,9,8,9,9,8,9,7,7,1,1,1,1,2,3,4,4,5,5,6,7,7]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Year<\/th>\n      <th>catch_mean<\/th>\n      <th>num_obs<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>The next csv to read in to a data frame contains full names that correspond to the region codes. This data frame will allow the addition of the region codes to the gathered catch data frame.</p>
<pre class="r"><code># Read in the region names csv from url
region_names = read.csv(url(&quot;https://knb.ecoinformatics.org/knb/d1/mn/v2/object/df35b.303.1&quot;, method = &quot;libcurl&quot;), stringsAsFactors = FALSE)</code></pre>
<p>Joins between data frames in R function similarly to SQL relational databases. For small data projects, data manipulation in R is likely adequate. For large datasets or datasets that require long-term maintenance, SQL is a better data manipulation language.</p>
<pre class="r"><code># Select and rename fields from the region_names data frame
region_names = region_names %&gt;%
  select(code, mgmtArea) %&gt;%
  rename(region = mgmtArea) %&gt;%
  rename(regionCode = code)

# Perform a left join to add the full region name to the catch_gather data frame
catch_gather = left_join(catch_gather, region_names, by = c(&#39;regionCode&#39; = &#39;regionCode&#39;))</code></pre>
<div id="data-preparation-exercise" class="section level2">
<h2><span class="header-section-number">4.1</span> Data Preparation Exercise</h2>
<pre class="r"><code># Read Andrew and Volk 2017 escapement goals csv into data frame
escapement_goals = read.csv(url(&quot;https://knb.ecoinformatics.org/knb/d1/mn/v2/object/knb.92014.1&quot;, method = &quot;libcurl&quot;), stringsAsFactors = FALSE)

# Filter escapement goals data frame to Bristol Bay region and sockeye salmon
escapement_goals = filter(escapement_goals, Species == &#39;Sockeye&#39; &amp; Region == &#39;Bristol Bay&#39; &amp; Type == &#39;SEG&#39;)

# Change Lower field to numeric in escapement goals
escapement_goals$Lower = as.numeric(escapement_goals$Lower)

# Replace &#39;eliminated&#39; value in Lower field with NA and change to numeric
escapement_goals = mutate(escapement_goals, Lower = ifelse(Lower == &quot;eliminated&quot;, NA, Lower), Lower = as.numeric(Lower))

# Select System, Upper, and Lower fields from escapement_goals
escapement_goals = select(escapement_goals, System, Lower, Upper)

# Read ADF&amp;G 2017 daily escapement counts csv into data frame
daily_escapement = read.csv(url(&quot;https://knb.ecoinformatics.org/knb/d1/mn/v2/object/knb.92020.1&quot;, method = &quot;libcurl&quot;), stringsAsFactors = FALSE)

# Filter escapement counts data frame to Bristol Bay region and sockeye salmon
daily_escapement = daily_escapement %&gt;%
  rename(Region = SASAP.Region) %&gt;%
  filter(Species == &#39;Sockeye&#39; &amp; Region == &#39;Bristol Bay&#39;)

# Parse date field to multiple fields 
daily_escapement = separate(daily_escapement, sampleDate, c(&quot;year&quot;, &quot;month&quot;, &quot;day&quot;), &quot;-&quot;)

# Calculate annual total escapements for each stock and integrate escapement goal upper and lower and store as new data frame
annual_escapement = daily_escapement %&gt;%
  group_by(year, Location) %&gt;%
  summarize(annualEscapement = sum(DailyCount))

# Perform an inner join between annual_escapement and escapement goals to join the upper and lower bounds to the annual escapement for systems/locations for which SEG escapement goals have been documented
annual_escapement = inner_join(annual_escapement, escapement_goals, by = c(&#39;Location&#39; = &#39;System&#39;))

# Add new field &#39;goalMet&#39; indicating a boolean for the statement &#39;The observed escapement was between the upper and lower goal bounds&#39;
annual_escapement$goalMet = annual_escapement$annualEscapement &gt; annual_escapement$Lower &amp; annual_escapement$annualEscapement &lt; annual_escapement$Upper

# Create empty vectors to hold data from loop
percentMet = NULL
stock = NULL

# Loop through unique values of &#39;Location&#39; field, which represent different stocks, calculate the percent of years for which SEG escapement goals were met, and append calculation value and stock name to vectors
for (i in unique(annual_escapement$Location)) {
  stock_escapement = filter(annual_escapement, Location == i)
  percentMet = append(percentMet, sum(stock_escapement$goalMet)/nrow(stock_escapement))
  stock = append(stock, i)
}

# Create data frame from the loop vectors
percent_met = data.frame(stock, percentMet)

# Display table
datatable(percent_met, caption=&#39;Percent of escapement goals met&#39;)</code></pre>
<div id="htmlwidget-37a6d9299da0ddc7fdfb" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-37a6d9299da0ddc7fdfb">{"x":{"filter":"none","caption":"<caption>Percent of escapement goals met<\/caption>","data":[["1","2","3","4","5","6","7","8"],["Nushagak River","Egegik River","Igushik River","Kvichak River","Naknek River","Togiak River","Ugashik River","Wood River"],[1,0.8,0.6,1,1,1,0.6,0.6]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>stock<\/th>\n      <th>percentMet<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="foundations-of-ggplot2" class="section level1">
<h1><span class="header-section-number">5</span> Foundations of ggplot2</h1>
<p>The aesthetic dataset should be mapped into the main ggplot, not the geometry. The geometry should be added afterwards. It is possible to add multiple datasets into a single plot, but they will have competing geometries. This causes a plot that is difficult to interpret. In general, a single plot should have a single aesthetic dataset.</p>
<p>The plot could have multiple geometries: for example, a point plot with a line of best fit. Adding geometries can be thought of as adding multiple layers using the same dataset mapping. Each line in a ggplot must be connected with a ‘+’.</p>
<p>Colors and fills and the column that differentiates colors are defined in the aesthetic. Aesthetics map the data. The mappings are different than the settings. Settings can be defined in the geometry.</p>
<pre class="r"><code># Read monthly salmon permit values into data frame
permits &lt;- read.csv(url(&quot;https://knb.ecoinformatics.org/knb/d1/mn/v2/object/urn%3Auuid%3Aa3c58bd6-481e-4c64-aa93-795df10a4664&quot;, method = &quot;libcurl&quot;), stringsAsFactors = FALSE)

# Define a new point plot based on the permits dataset with color set to &#39;Gear&#39; field
ggplot(permits, aes(Value, StdDev, color = Gear)) +
  geom_point() +
  theme_bw()</code></pre>
<pre><code>## Warning: Removed 223 rows containing missing values (geom_point).</code></pre>
<p><img src="sasap_workshop_files/figure-html/foundationsggplot2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The size of the geometry can be defined as a constant or variable. For example, the size of points can be defined by a varible in the dataset.</p>
<pre class="r"><code># Modify point plot based on the permits dataset with size set to &#39;Range&#39; field
ggplot(permits, aes(Value, StdDev, color = Gear, size = Range)) +
  geom_point() +
  theme_bw()</code></pre>
<pre><code>## Warning: Removed 223 rows containing missing values (geom_point).</code></pre>
<p><img src="sasap_workshop_files/figure-html/sizeggplot2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The type of plot is always defined by the geometry. The ggplot2 documentation includes links to all of the types of plots that are possible. The aesthetic arguments change depending on the geometry. For example, histograms only have an x axis defined.</p>
<p>In markdown, two plots produced in the same code chunk will be toggle-able by thumbnails. Discrete axes can be reordered by explicitly defining either an order as vector or a sort order.</p>
<pre class="r"><code># Create a column plot with the x axis defined as the &#39;Gear&#39; field
permits %&gt;%
  group_by(Gear) %&gt;%
  summarize(meanval = mean(Value, na.rm = TRUE)) %&gt;%
  ggplot(aes(x=Gear, y=meanval/sum(meanval))) +
    geom_col() +
    scale_y_continuous(labels = scales::percent)</code></pre>
<p><img src="sasap_workshop_files/figure-html/definingPlotTypes-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Creat a violin plot of just the data from Cook Inlet
permits_CookInlet = filter(permits, Region == &#39;Cook Inlet&#39;)

ggplot(permits_CookInlet, aes(x=Gear, y=Value)) +
  geom_violin() +
  theme_bw()</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_ydensity).</code></pre>
<p><img src="sasap_workshop_files/figure-html/definingPlotTypes-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Create a violin plot of just the data from Bristol Bay
permits_BristolBay = filter(permits, Region == &#39;Bristol Bay&#39;)

ggplot(permits_BristolBay, aes(x=Gear, y=Value)) +
  geom_violin() +
  theme_bw()</code></pre>
<p><img src="sasap_workshop_files/figure-html/definingPlotTypes-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>Geometry-specific settings can be added per geometry when adding multiple layers so that the layers match better, etc.</p>
<pre class="r"><code># Add point geometry overlaying violin geometry
ggplot(permits_CookInlet, aes(x=Gear, y=Value)) +
  geom_violin() +
  geom_point(position = &#39;jitter&#39;, shape = 1) +
  theme_bw()</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_ydensity).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="sasap_workshop_files/figure-html/multipleLayers-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Add point geometry over a smoothing algorithm
ggplot(permits_CookInlet, aes(x=Value, y=StdDev)) +
  geom_smooth(method = &#39;loess&#39;) +
  geom_point() +
  theme_bw()</code></pre>
<pre><code>## Warning: Removed 27 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 27 rows containing missing values (geom_point).</code></pre>
<p><img src="sasap_workshop_files/figure-html/multipleLayers-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>Scales can be defined based on limits in the data. Defining scales should be done after adding geometries. The scales can also be defined as cartesian coorindates limits.</p>
<pre class="r"><code># Create a new data frame of permits in Southeast using Purse Seine gear
permits_Southeast = filter(permits, Region == &#39;Southeast&#39; &amp; Gear == &#39;Purse Seine&#39;)

# Define scales in plot using scale_continuous
ggplot(permits_Southeast, aes(x=Year, y=Value)) +
  geom_point() +
  geom_line() +
  scale_y_continuous(limits = c(0, max(permits_Southeast$Value))) +
  scale_x_continuous(limits = c(2000, max(permits_Southeast$Year))) +
  theme_bw()</code></pre>
<pre><code>## Warning: Removed 18 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 18 rows containing missing values (geom_path).</code></pre>
<p><img src="sasap_workshop_files/figure-html/plotScales-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Define scales in plot usings cartesian coordinates
ggplot(permits_Southeast, aes(x=Year, y=Value)) +
  geom_point() +
  geom_line() +
  coord_cartesian(xlim = c(2000, 2000, max(permits_Southeast$Year)), ylim = c(0, max(permits_Southeast$Value))) +
  theme_bw()</code></pre>
<p><img src="sasap_workshop_files/figure-html/plotScales-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>Scale colors can be defined using the hue setting. Scale color brewer is an easy way to set colors using predefined color schemes. The type of scale in either dimension can be defined according to settings available in the ggplot documentation.</p>
<pre class="r"><code># Define color scheme and axis type
ggplot(permits, aes(x=Value, y=StdDev, color = Gear)) +
  geom_point() +
  scale_color_brewer(palette = &quot;Paired&quot;) +
  scale_x_log10() +
  theme_bw()</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning: Removed 223 rows containing missing values (geom_point).</code></pre>
<p><img src="sasap_workshop_files/figure-html/colorScheme-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Plots can be broken into discrete sub-plots using the facet function. The tilda specifies the variable by which to split the sub-plots. Facet wrap is used for one-dimensional sequences and facet grid is used for two-dimensional sequences.</p>
<pre class="r"><code># Create a plot that is faceted based on &#39;Gear&#39; field
ggplot(permits, aes(x=Year, y=Value)) +
  geom_point() +
  facet_wrap(~Gear) +
  theme_bw()</code></pre>
<pre><code>## Warning: Removed 14 rows containing missing values (geom_point).</code></pre>
<p><img src="sasap_workshop_files/figure-html/facets-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Defining labels can be done using the ‘labs’ function.</p>
<pre class="r"><code># Set the labels for the titles and y-axis
ggplot(permits, aes(x=Year, y=Value)) +
  geom_point() +
  facet_wrap(~Gear, ncol = 2, scales = &#39;free&#39;) +
  labs(y = &#39;Permit Value&#39;, title = &#39;Permits by Gear Type&#39;, subtitle = &#39;I am a computer&#39;) +
  theme_bw()</code></pre>
<pre><code>## Warning: Removed 14 rows containing missing values (geom_point).</code></pre>
<p><img src="sasap_workshop_files/figure-html/titles-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Pre-existing themes for ggplot2 are available. These change the styling with pre-configured settings for background, axes, etc. The default is theme_gray. The available themes are available on the ggplot2 documentation.</p>
<pre class="r"><code># Change the theme to a different pre-configured option
ggplot(permits, aes(x=Year, y=Value)) +
  geom_point() +
  facet_wrap(~Gear) +
  labs(y = &#39;Permit Value&#39;, title = &#39;Permits by Gear Type&#39;, subtitle = &#39;I am a computer&#39;) +
  theme_dark()</code></pre>
<pre><code>## Warning: Removed 14 rows containing missing values (geom_point).</code></pre>
<p><img src="sasap_workshop_files/figure-html/themes-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Themes can also be used to modify the general styling of a plot. The ggplot2 documentation has a full list of the options that are available through the theme. The theme modifies the elements of background elements and elements surrounding the aesthetic/geometries.</p>
<pre class="r"><code># Change the theme settings to move the legend to the bottom
ggplot(permits, aes(x=Value, y=StdDev, color = Gear)) +
  geom_point() +
  scale_color_brewer(palette = &quot;Paired&quot;) +
  scale_x_log10() +
  theme(legend.position = &quot;bottom&quot;) +
  theme_bw()</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning: Removed 223 rows containing missing values (geom_point).</code></pre>
<p><img src="sasap_workshop_files/figure-html/themeSettings-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You can also save the theme as a variable and call it into a plot. If the theme is in an external script that is called in then you would be able to apply the same theme across plots in multiple projects. The same idea applies to other settings (i.e. you can set any plot aspect to a variable). Plots can also be built into functions that are then applied to many datasets. This would allow changing all plots by changing the function. Or you could build a personal plotting package with functions for multiple plot geometries and call it into your scripts as a library.</p>
<pre class="r"><code># Change the theme settings to move the legend to the bottom
my_theme = theme(axis.title = element_text(size=16), axis.text = element_text(size = 12))

ggplot(permits, aes(x=Value, y=StdDev, color = Gear)) +
  geom_point() +
  scale_color_brewer(palette = &quot;Paired&quot;) +
  scale_x_log10() +
  labs(y = &#39;Permit Value&#39;, title = &#39;Permits by Gear Type&#39;, subtitle = &#39;I am a computer&#39;) +
  my_theme +
  theme_bw()</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning: Removed 223 rows containing missing values (geom_point).</code></pre>
<p><img src="sasap_workshop_files/figure-html/saveTheme-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Plots can be easily saved using “ggsave” command. This method works better for ggplot2 than any of the export methods from base R.</p>
<pre class="r"><code># Save plot as a variable
my_plot = ggplot(permits, aes(x=Value, y=StdDev, color = Gear)) +
  geom_point() +
  scale_color_brewer(palette = &quot;Paired&quot;) +
  scale_x_log10() +
  labs(y = &#39;Permit Value&#39;, title = &#39;Permits by Gear Type&#39;, subtitle = &#39;I am a computer&#39;) +
  my_theme +
  theme_bw()

# Export plot to png
ggsave(&#39;fish.png&#39;, plot = my_plot, width = 5)</code></pre>
<pre><code>## Saving 5 x 5 in image</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning: Removed 223 rows containing missing values (geom_point).</code></pre>
</div>
<div id="publishing-data-workflows-and-products-to-the-web-for-collaboration" class="section level1">
<h1><span class="header-section-number">6</span> Publishing data, workflows, and products to the web for collaboration</h1>
<p>Github pages works by setting up an index.html file in the repository. The index.html file can be generated using rmarkdown (or they could be generated using other methods).</p>
<pre class="r"><code># Read ADF&amp;G 2017 daily escapement counts csv into data frame
daily_escapement = read.csv(url(&quot;https://knb.ecoinformatics.org/knb/d1/mn/v2/object/knb.92020.1&quot;, method = &quot;libcurl&quot;), stringsAsFactors = FALSE)

# Filter escapement counts data frame to Bristol Bay region and sockeye salmon
daily_escapement = daily_escapement %&gt;%
  rename(Region = SASAP.Region)

# Parse date field to multiple fields 
daily_escapement = separate(daily_escapement, sampleDate, c(&quot;year&quot;, &quot;month&quot;, &quot;day&quot;), &quot;-&quot;)

# Calculate the sum escapement for annual escapement per
median_escapement = daily_escapement %&gt;%
  group_by(Species, Region, year, Location) %&gt;%
  summarize(escapement = sum(DailyCount))

# Calculate median escapement by species
median_escapement = median_escapement %&gt;%
  group_by(Species) %&gt;%
  summarize(medianEscapement = median(escapement))

# Create a plot of median escapement by species
ggplot(median_escapement, aes(Species, medianEscapement)) +
  geom_col() +
  coord_flip() +
  theme_bw()</code></pre>
<p><img src="sasap_workshop_files/figure-html/medianEscapement-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Identify unique locations and add to new data frame
locations = daily_escapement %&gt;%
  distinct(Location, Latitude, Longitude) %&gt;%
  drop_na()

# Correct positive longitudes
locations$Longitude = ifelse(locations$Longitude &lt; 0, locations$Longitude, locations$Longitude * -1)

# Add data table display to the R markdown output
datatable(locations)</code></pre>
<div id="htmlwidget-8becdc5a88ac0d275d0b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-8becdc5a88ac0d275d0b">{"x":{"filter":"none","data":[["1","4","6","7","8","9","10","12","13","14","15","18","20","23","27","29","30","35","36","37","38","43","45","46","50","57","58","60","62","70","74","76","77","78","79","80","84","85","87","88","89","91","92","97","99","101","102","103","104","106","109","111","116","118","119","122","129","130","133","134","136","137","138","139","140","141","142","147"],["Akalura Creek","Anvik River","Ayakulik River","Bear Creek","Bear River","Big Bay Creek","Big Kitoi Creek","Black Lake","Buskin River","Chelatna Lake","Chignik River","Coghill River","Crescent River","Dog Salmon Creek","Eagle Sonar (Yukon/Canadian Border)","Egegik River","Eshamy River","Frazer Lake","Frosty Creek","George River","Goodnews River (Middle Fork)","Horse Marine Stream","Igushik River","Ilnik River","Judd Lake","Kanektok River","Karluk","Kasilof River","Kenai River","Kogrukluk River","Kvichak River","Lake Louise","Larson Lake","Litnik","Little Kitoi","Little River","Little Waterfall","Malina Creek","McLees","Middle Lagoon","Miles Lake","Morris Cove","Mortensens Creek","Naknek River","Nelson River","Nushagak River","Orzinski River","Pasagshak River","Pauls Bay","Pilot Station Sonar","Portage","Red Lake","Salmon River (Aniak)","Saltery Creek","Sandy River","Seal Bay Creek","Sturgeon River","Summer Bay","Takotna River","Tatlawiksuk River","Telaquana River","Thin Point Cove","Thorsheim","Togiak River","Uganik River","Ugashik River","Upper Station","Wood River"],[57.1641,62.7,57.1956,56.0389,56.0389,58.5426,58.1915,56.392,57.7768,62.4731,56.2623,61.0726,60.2252,57.1289,64.8,58.2461,60.4528,57.2027,55.1944,61.9,59.1,57.112,58.7132,55.8141,61.5706,59.8,57.563,60.3865,60.548,60.8,58.7969,57.7605,62.3387,58.0815,58.1963,57.7784,58.3955,58.173,54.0002,55.0827,60.6798,53.9167,55.1469,58.7173,55.8141,58.8677,55.731,57.4734,58.3898,62,56.2896,57.2648,61.1,57.5263,56.2163,58.3388,57.3388,53.8963,63,61.9,61.1,55.0109,58.2765,59.0722,57.6696,57.4881,57.0581,59.0523],[-154.2287,-160.2,-154.529,-160.2734,-160.2734,-152.5683,-152.3754,-158.937,-152.5372,-151.4545,-158.7054,-147.9109,-152.5585,-154.0287,-141,-157.6254,-148.1,-154.0573,-162.8535,-157.7,-161.5,-153.95,-158.8739,-161.2349,-151.5575,-161.9,-154.3843,-151.3001,-151.2642,-157.8,-157.0993,-152.5055,-149.892,-152.8286,-152.3681,-153.6666,-152.5058,-153.2158,-166.7281,-163.2164,-144.6684,-166.463,-162.6372,-157.053,-161.2349,-158.605,-160.0934,-152.4627,-152.3405,-162.9,-152.4284,-154.3573,-159.2,-152.7619,-160.055,-152.2238,-154.6931,-166.4596,-155.6,-156.2,-154.4,-162.6734,-152.8367,-160.3363,-153.3737,-157.5958,-154.3569,-158.4141]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Location<\/th>\n      <th>Latitude<\/th>\n      <th>Longitude<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div id="simple-web-mapping" class="section level2">
<h2><span class="header-section-number">6.1</span> Simple web mapping</h2>
<p>Leaflet is a javascript mapping application. R has a package to interface with leaflet.</p>
<pre class="r"><code># Add a marker
markerIcon &lt;- makeIcon(
  iconUrl = &quot;https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/images/marker-icon.png&quot;,
  iconWidth = 25, iconHeight = 41,
  iconAnchorX = 12, iconAnchorY = 41,
  shadowUrl = &quot;https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/images/marker-shadow.png&quot;,
  shadowWidth = 41, shadowHeight = 41,
  shadowAnchorX = 13, shadowAnchorY = 41
)

# Create a leaflet map based on the locations
leaflet(locations) %&gt;% 
  addTiles() %&gt;% 
  addMarkers(~ Longitude, ~ Latitude, popup = ~ Location, icon = markerIcon)</code></pre>
<div id="htmlwidget-2cbed3ce0fc703b7e93c" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-2cbed3ce0fc703b7e93c">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[[57.1641,62.7,57.1956,56.0389,56.0389,58.5426,58.1915,56.392,57.7768,62.4731,56.2623,61.0726,60.2252,57.1289,64.8,58.2461,60.4528,57.2027,55.1944,61.9,59.1,57.112,58.7132,55.8141,61.5706,59.8,57.563,60.3865,60.548,60.8,58.7969,57.7605,62.3387,58.0815,58.1963,57.7784,58.3955,58.173,54.0002,55.0827,60.6798,53.9167,55.1469,58.7173,55.8141,58.8677,55.731,57.4734,58.3898,62,56.2896,57.2648,61.1,57.5263,56.2163,58.3388,57.3388,53.8963,63,61.9,61.1,55.0109,58.2765,59.0722,57.6696,57.4881,57.0581,59.0523],[-154.2287,-160.2,-154.529,-160.2734,-160.2734,-152.5683,-152.3754,-158.937,-152.5372,-151.4545,-158.7054,-147.9109,-152.5585,-154.0287,-141,-157.6254,-148.1,-154.0573,-162.8535,-157.7,-161.5,-153.95,-158.8739,-161.2349,-151.5575,-161.9,-154.3843,-151.3001,-151.2642,-157.8,-157.0993,-152.5055,-149.892,-152.8286,-152.3681,-153.6666,-152.5058,-153.2158,-166.7281,-163.2164,-144.6684,-166.463,-162.6372,-157.053,-161.2349,-158.605,-160.0934,-152.4627,-152.3405,-162.9,-152.4284,-154.3573,-159.2,-152.7619,-160.055,-152.2238,-154.6931,-166.4596,-155.6,-156.2,-154.4,-162.6734,-152.8367,-160.3363,-153.3737,-157.5958,-154.3569,-158.4141],{"iconUrl":{"data":"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/images/marker-icon.png","index":0},"iconWidth":25,"iconHeight":41,"iconAnchorX":12,"iconAnchorY":41,"shadowUrl":{"data":"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/images/marker-shadow.png","index":0},"shadowWidth":41,"shadowHeight":41,"shadowAnchorX":13,"shadowAnchorY":41},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["Akalura Creek","Anvik River","Ayakulik River","Bear Creek","Bear River","Big Bay Creek","Big Kitoi Creek","Black Lake","Buskin River","Chelatna Lake","Chignik River","Coghill River","Crescent River","Dog Salmon Creek","Eagle Sonar (Yukon/Canadian Border)","Egegik River","Eshamy River","Frazer Lake","Frosty Creek","George River","Goodnews River (Middle Fork)","Horse Marine Stream","Igushik River","Ilnik River","Judd Lake","Kanektok River","Karluk","Kasilof River","Kenai River","Kogrukluk River","Kvichak River","Lake Louise","Larson Lake","Litnik","Little Kitoi","Little River","Little Waterfall","Malina Creek","McLees","Middle Lagoon","Miles Lake","Morris Cove","Mortensens Creek","Naknek River","Nelson River","Nushagak River","Orzinski River","Pasagshak River","Pauls Bay","Pilot Station Sonar","Portage","Red Lake","Salmon River (Aniak)","Saltery Creek","Sandy River","Seal Bay Creek","Sturgeon River","Summer Bay","Takotna River","Tatlawiksuk River","Telaquana River","Thin Point Cove","Thorsheim","Togiak River","Uganik River","Ugashik River","Upper Station","Wood River"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[53.8963,64.8],"lng":[-166.7281,-141]}},"evals":[],"jsHooks":[]}</script>
<p>The End!</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
